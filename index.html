<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UnlockMyLead - Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
        body {
            font-family: 'Inter', sans-serif;
        }
        .glow-button {
            transition: all 0.3s ease;
        }
        .glow-button:hover {
            box-shadow: 0 0 15px rgba(226, 114, 91, 0.5); /* Terracotta glow */
            transform: translateY(-2px);
        }
        .active-link {
            background-color: #192350; /* Slightly lighter navy for active state */
        }
    </style>
</head>
<body class="bg-[#111A3E] text-white antialiased flex flex-col lg:flex-row min-h-screen">

    <!-- Sidebar Navigation -->
    <aside id="sidebar" class="bg-[#192350] p-6 w-full lg:w-64 lg:min-h-screen flex flex-col justify-between shadow-lg fixed lg:sticky top-0 left-0 z-50 transform -translate-x-full lg:translate-x-0 transition-transform duration-300 ease-in-out">
        <div>
            <div class="flex items-center justify-between lg:justify-center mb-10">
                <h1 class="text-3xl font-bold text-[#E2725B]">Unlock</h1>
                <button id="closeSidebar" class="lg:hidden text-gray-400 hover:text-white transition-colors">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                    </svg>
                </button>
            </div>

            <nav class="space-y-2">
                <a href="#dashboard" class="flex items-center p-3 rounded-lg text-lg font-medium hover:bg-gray-700 transition-colors duration-200">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mr-3" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"/>
                    </svg>
                    Dashboard
                </a>
                <a href="#campaigns" class="flex items-center p-3 rounded-lg text-lg font-medium hover:bg-gray-700 transition-colors duration-200 active-link">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mr-3" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5.882V19.24m2.03-9.589L20 7.828M13.03 9.651L2 12.012m6.305-1.996L17.788 17.514M11.954 14.508l-5.698 5.485"/>
                    </svg>
                    Campaigns
                </a>
                <a href="#analytics" class="flex items-center p-3 rounded-lg text-lg font-medium hover:bg-gray-700 transition-colors duration-200">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mr-3" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 8v8m-4-8v8m-4-8v8m-8-2h18M4 12v-2M20 12v-2"/>
                    </svg>
                    Analytics
                </a>
                <a href="#leads" class="flex items-center p-3 rounded-lg text-lg font-medium hover:bg-gray-700 transition-colors duration-200">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mr-3" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.5l8 4.5-8 4.5-8-4.5zM20 9l-8 4.5-8-4.5M12 14.5l8 4.5-8 4.5-8-4.5"/>
                    </svg>
                    Leads
                </a>
                <a href="#inbox" class="flex items-center p-3 rounded-lg text-lg font-medium hover:bg-gray-700 transition-colors duration-200">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mr-3" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8m-2 10a2 2 0 01-2 2H7a2 2 0 01-2-2V8a2 2 0 012-2h10a2 2 0 012 2v10z"/>
                    </svg>
                    Inbox
                </a>
                <a href="#settings" class="flex items-center p-3 rounded-lg text-lg font-medium hover:bg-gray-700 transition-colors duration-200">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mr-3" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 21a9 9 0 009-9h-9m-9 9a9 9 0 019-9v9m-9 9a9 9 0 009-9H3a9 9 0 009 9zm9-9a9 9 0 01-9 9v-9m9-9a9 9 0 00-9 9v-9m9 9a9 9 0 00-9-9H3a9 9 0 009 9z"/>
                    </svg>
                    Settings
                </a>
            </nav>
        </div>
        <div class="mt-8">
            <button id="logoutButton" class="w-full flex items-center p-3 rounded-lg text-lg font-bold bg-red-600 hover:bg-red-700 text-white transition-colors duration-300">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mr-3" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"/>
                </svg>
                Log Out
            </button>
        </div>
    </aside>

    <!-- Main Content Area -->
    <main class="flex-grow p-6 lg:p-10 transition-all duration-300 ease-in-out">
        <!-- Mobile Header -->
        <div class="lg:hidden flex justify-between items-center mb-6">
            <h1 class="text-3xl font-bold text-[#E2725B]">Dashboard</h1>
            <button id="openSidebar" class="text-gray-400 hover:text-white transition-colors">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7" />
                </svg>
            </button>
        </div>

        <!-- Dynamic Content Sections -->
        <div id="dashboard-content" class="space-y-10">
            <!-- Campaigns Section -->
            <section id="campaigns" class="content-section">
                <h2 class="text-3xl font-bold text-white mb-6">Campaign Management</h2>

                <div class="bg-[#192350] p-6 rounded-2xl shadow-lg border border-gray-700 mb-8">
                    <h3 class="text-xl font-bold text-white mb-4">Create New Campaign</h3>
                    <form id="createCampaignForm" class="space-y-4">
                        <div>
                            <label for="campaignName" class="block text-sm font-medium text-gray-400">Campaign Name</label>
                            <input type="text" id="campaignName" name="campaignName" required
                                class="w-full px-4 py-2 rounded-lg border border-gray-700 bg-gray-700 text-white focus:outline-none focus:ring-2 focus:ring-[#E2725B] transition duration-200">
                        </div>
                        <div>
                            <label for="contactSource" class="block text-sm font-medium text-gray-400">Contact Source</label>
                            <select id="contactSource" name="contactSource" class="w-full px-4 py-2 rounded-lg border border-gray-700 bg-gray-700 text-white focus:outline-none focus:ring-2 focus:ring-[#E2725B] transition duration-200">
                                <option value="manual">Test Phone Number</option>
                                <option value="csv">Import from CSV</option>
                                <option value="crm">Import from CRM</option>
                            </select>
                        </div>
                        <div id="manualInput" class="space-y-4">
                            <label for="targetPhoneNumber" class="block text-sm font-medium text-gray-400">Test Phone Number (e.g., +1234567890)</label>
                            <input type="tel" id="targetPhoneNumber" name="targetPhoneNumber"
                                class="w-full px-4 py-2 rounded-lg border border-gray-700 bg-gray-700 text-white focus:outline-none focus:ring-2 focus:ring-[#E2725B] transition duration-200">
                        </div>
                        <div id="csvInput" class="hidden space-y-4">
                             <label for="csvFile" class="block text-sm font-medium text-gray-400">Upload CSV File</label>
                            <input type="file" id="csvFile" name="csvFile" accept=".csv"
                                class="w-full px-4 py-2 rounded-lg border border-gray-700 bg-gray-700 text-white focus:outline-none focus:ring-2 focus:ring-[#E2725B] transition duration-200">
                        </div>
                         <div id="crmInput" class="hidden space-y-4">
                            <label for="crmSource" class="block text-sm font-medium text-gray-400">Select CRM</label>
                            <select id="crmSource" name="crmSource" class="w-full px-4 py-2 rounded-lg border border-gray-700 bg-gray-700 text-white focus:outline-none focus:ring-2 focus:ring-[#E2725B] transition duration-200">
                                <option value="">Select a connected CRM</option>
                                <option value="hubspot">HubSpot</option>
                                <option value="zoho">Zoho CRM</option>
                                <option value="bitrix">Bitrix24</option>
                            </select>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <div>
                                <label for="aiLanguage" class="block text-sm font-medium text-gray-400">AI Language</label>
                                <select id="aiLanguage" name="aiLanguage" class="w-full px-4 py-2 rounded-lg border border-gray-700 bg-gray-700 text-white focus:outline-none focus:ring-2 focus:ring-[#E2725B] transition duration-200">
                                     <option value="en-US">English (US)</option>
                                     <option value="en-GB">English (UK)</option>
                                     <option value="en-AU">English (Australia)</option>
                                     <option value="en-IN">English (India)</option>
                                     <option value="ar-EG">Arabic (Egypt)</option>
                                     <option value="tr-TR">Turkish (Turkey)</option>
                                     <option value="es-ES">Spanish (Spain)</option>
                                     <option value="es-MX">Spanish (Mexico)</option>
                                     <option value="fr-FR">French (France)</option>
                                     <option value="de-DE">German (Germany)</option>
                                     <option value="ja-JP">Japanese (Japan)</option>
                                     <option value="ko-KR">Korean (Korea)</option>
                                     <option value="pt-BR">Portuguese (Brazil)</option>
                                     <option value="ru-RU">Russian (Russia)</option>
                                     <option value="zh-CN">Chinese (Mandarin)</option>
                                     <option value="nl-NL">Dutch (Netherlands)</option>
                                     <option value="it-IT">Italian (Italy)</option>
                                     <option value="pl-PL">Polish (Poland)</option>
                                     <option value="sv-SE">Swedish (Sweden)</option>
                                     <option value="da-DK">Danish (Denmark)</option>
                                     <option value="fi-FI">Finnish (Finland)</option>
                                     <option value="nb-NO">Norwegian (Norway)</option>
                                     <option value="id-ID">Indonesian (Indonesia)</option>
                                     <option value="th-TH">Thai (Thailand)</option>
                                     <option value="vi-VN">Vietnamese (Vietnam)</option>
                                     <option value="el-GR">Greek (Greece)</option>
                                     <option value="hu-HU">Hungarian (Hungary)</option>
                                     <option value="cs-CZ">Czech (Czech Republic)</option>
                                     <option value="sk-SK">Slovak (Slovakia)</option>
                                     <option value="uk-UA">Ukrainian (Ukraine)</option>
                                     <option value="ro-RO">Romanian (Romania)</option>
                                     <option value="bg-BG">Bulgarian (Bulgaria)</option>
                                     <option value="hr-HR">Croatian (Croatia)</option>
                                     <option value="et-EE">Estonian (Estonia)</option>
                                     <option value="lt-LT">Lithuanian (Lithuania)</option>
                                     <option value="lv-LV">Latvian (Latvia)</option>
                                     <option value="sl-SI">Slovenian (Slovenia)</option>
                                     <option value="sr-RS">Serbian (Serbia)</option>
                                     <option value="mk-MK">Macedonian (Macedonia)</option>
                                     <option value="sq-AL">Albanian (Albania)</option>
                                </select>
                            </div>
                            <div>
                                <label for="aiTone" class="block text-sm font-medium text-gray-400">AI Tone</label>
                                <select id="aiTone" name="aiTone" class="w-full px-4 py-2 rounded-lg border border-gray-700 bg-gray-700 text-white focus:outline-none focus:ring-2 focus:ring-[#E2725B] transition duration-200">
                                    <option value="Kore">Firm</option>
                                    <option value="Zephyr">Bright</option>
                                    <option value="Puck">Upbeat</option>
                                    <option value="Charon">Informative</option>
                                    <option value="en-IN-Male">Indian English (Male)</option>
                                    <option value="en-IN-Female">Indian English (Female)</option>
                                    <option value="en-AU-Male">Australian English (Male)</option>
                                    <option value="en-GB-Male">British English (Male)</option>
                                    <option value="es-MX-Male">Mexican Spanish (Male)</option>
                                    <option value="es-ES-Female">Spanish (Female)</option>
                                    <option value="tr-TR-Male">Turkish (Male)</option>
                                    <option value="ar-EG-Female">Arabic (Female)</option>
                                </select>
                            </div>
                            <div>
                                <label for="aiTemperature" class="block text-sm font-medium text-gray-400">AI Creativity (Temperature)</label>
                                <input type="range" id="aiTemperature" name="aiTemperature" min="0" max="1" step="0.1" value="0.7" class="w-full h-8 cursor-pointer accent-[#E2725B]">
                                <span class="text-xs text-gray-400">Current: <span id="tempValue">0.7</span></span>
                            </div>
                        </div>
                        <div>
                            <label for="campaignScript" class="block text-sm font-medium text-gray-400">AI Call Script</label>
                            <textarea id="campaignScript" name="campaignScript" rows="5" required
                                class="w-full px-4 py-2 rounded-lg border border-gray-700 bg-gray-700 text-white focus:outline-none focus:ring-2 focus:ring-[#E2725B] transition duration-200" placeholder="Hello, this is a call to test the system of Unlock My Lead."></textarea>
                        </div>
                        <button type="submit" id="createCampaignBtn" class="glow-button w-full px-6 py-3 rounded-lg font-bold bg-[#E2725B] hover:bg-[#C86650] text-white transition-colors duration-300">
                            Create Campaign
                        </button>
                        <div id="formMessage" class="mt-4 text-center text-sm font-medium hidden"></div>
                    </form>
                </div>

                <div class="bg-[#192350] p-6 rounded-2xl shadow-lg border border-gray-700">
                    <h3 class="text-xl font-bold text-white mb-4">My Campaigns</h3>
                    <div class="overflow-x-auto">
                        <table class="min-w-full divide-y divide-gray-700">
                            <thead>
                                <tr>
                                    <th class="px-6 py-3 text-left text-xs font-semibold text-gray-400 uppercase tracking-wider">Name</th>
                                    <th class="px-6 py-3 text-left text-xs font-semibold text-gray-400 uppercase tracking-wider">Leads</th>
                                    <th class="px-6 py-3 text-left text-xs font-semibold text-gray-400 uppercase tracking-wider">Status</th>
                                    <th class="px-6 py-3 text-left text-xs font-semibold text-gray-400 uppercase tracking-wider">Created</th>
                                    <th class="px-6 py-3 text-left text-xs font-semibold text-gray-400 uppercase tracking-wider">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="campaignsTableBody" class="divide-y divide-gray-700">
                                <tr>
                                    <td colspan="5" class="py-4 text-center text-gray-400">Loading campaigns...</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <!-- Analytics Section -->
            <section id="analytics" class="content-section hidden">
                <h2 class="text-3xl font-bold text-white mb-8">Campaign Analytics</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-10">
                    <div class="bg-[#192350] p-6 rounded-2xl shadow-lg border border-gray-700 flex items-center">
                        <div class="p-3 bg-[#E2725B] rounded-full mr-4">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.5l1.5 3.5 4.5-2.5 1.5 3.5H19a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2V5z"/>
                            </svg>
                        </div>
                        <div>
                            <h3 class="text-md font-semibold text-gray-400">Total Calls</h3>
                            <p id="totalCalls" class="text-3xl font-extrabold text-white mt-1">--</p>
                        </div>
                    </div>
                    <div class="bg-[#192350] p-6 rounded-2xl shadow-lg border border-gray-700 flex items-center">
                        <div class="p-3 bg-green-500 rounded-full mr-4">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 6a9 9 0 11-18 0 9 9 0 0118 0z"/>
                            </svg>
                        </div>
                        <div>
                            <h3 class="text-md font-semibold text-gray-400">Successful Connections</h3>
                            <p id="successfulConnections" class="text-3xl font-extrabold text-white mt-1">--</p>
                        </div>
                    </div>
                    <div class="bg-[#192350] p-6 rounded-2xl shadow-lg border border-gray-700 flex items-center">
                        <div class="p-3 bg-yellow-500 rounded-full mr-4">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c1.657 0 3 1.343 3 3s-1.343 3-3 3-3-1.343-3-3 1.343-3 3-3z"/>
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 18h.01M18.707 5.293a1 1 0 00-1.414 0L12 10.586l-5.293-5.293a1 1 0 00-1.414 1.414L10.586 12l-5.293 5.293a1 1 0 001.414 1.414L12 13.414l5.293 5.293a1 1 0 001.414-1.414L13.414 12z"/>
                            </svg>
                        </div>
                        <div>
                            <h3 class="text-md font-semibold text-gray-400">Leads Qualified</h3>
                            <p id="leadsQualified" class="text-3xl font-extrabold text-white mt-1">--</p>
                        </div>
                    </div>
                    <div class="bg-[#192350] p-6 rounded-2xl shadow-lg border border-gray-700 flex items-center">
                        <div class="p-3 bg-orange-500 rounded-full mr-4">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 9l4 4m0 0l-4 4m4 4H3m6 4a9 9 0 11-18 0 9 9 0 0118 0z"/>
                            </svg>
                        </div>
                        <div>
                            <h3 class="text-md font-semibold text-gray-400">Follow-Ups Sent</h3>
                            <p id="followUpsSent" class="text-3xl font-extrabold text-white mt-1">--</p>
                        </div>
                    </div>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-10">
                    <div class="bg-[#192350] p-6 rounded-2xl shadow-lg border border-gray-700">
                        <h3 class="text-lg font-bold text-white mb-4">Call Funnel Conversion</h3>
                        <canvas id="conversionChart"></canvas>
                    </div>
                    <div class="bg-[#192350] p-6 rounded-2xl shadow-lg border border-gray-700">
                        <h3 class="text-lg font-bold text-white mb-4">Activity Over Time</h3>
                        <canvas id="activityChart"></canvas>
                    </div>
                </div>

                <div class="bg-[#192350] p-6 rounded-2xl shadow-lg border border-gray-700">
                    <h3 class="text-lg font-bold text-white mb-4">Recent Activity</h3>
                    <div class="overflow-x-auto">
                        <table class="min-w-full divide-y divide-gray-700">
                            <thead>
                                <tr>
                                    <th class="px-6 py-3 text-left text-xs font-semibold text-gray-400 uppercase tracking-wider">Time</th>
                                    <th class="px-6 py-3 text-left text-xs font-semibold text-gray-400 uppercase tracking-wider">Contact</th>
                                    <th class="px-6 py-3 text-left text-xs font-semibold text-gray-400 uppercase tracking-wider">Company</th>
                                    <th class="px-6 py-3 text-left text-xs font-semibold text-gray-400 uppercase tracking-wider">Outcome</th>
                                </tr>
                            </thead>
                            <tbody id="activityTableBody" class="divide-y divide-gray-700">
                                <tr>
                                    <td colspan="4" class="py-4 text-center text-gray-400">No activity yet.</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <!-- Leads Section -->
            <section id="leads" class="content-section hidden">
                <h2 class="text-3xl font-bold text-white mb-6">B2B Lead Generation</h2>
                <div class="bg-[#192350] p-6 rounded-2xl shadow-lg border border-gray-700 flex items-center mb-8">
                    <div class="p-3 bg-[#E2725B] rounded-full mr-4">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c1.657 0 3 1.343 3 3s-1.343 3-3 3-3-1.343-3-3 1.343-3 3-3z"/>
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 18h.01M18.707 5.293a1 1 0 00-1.414 0L12 10.586l-5.293-5.293a1 1 0 00-1.414 1.414L10.586 12l-5.293 5.293a1 1 0 001.414 1.414L12 13.414l5.293 5.293a1 1 0 001.414-1.414L13.414 12z"/>
                        </svg>
                    </div>
                    <div>
                        <h3 class="text-md font-semibold text-gray-400">Your Current Credits</h3>
                        <p id="userCredits" class="text-3xl font-extrabold text-white mt-1">--</p>
                    </div>
                </div>
                <div class="bg-[#192350] p-6 rounded-2xl shadow-lg border border-gray-700 mb-8">
                    <h3 class="text-xl font-bold text-white mb-4">Find New Leads</h3>
                    <form id="leadSearchForm" class="space-y-4">
                        <div>
                            <label for="keywords" class="block text-sm font-medium text-gray-400">Keywords</label>
                            <input type="text" id="keywords" name="keywords" required class="w-full px-4 py-2 rounded-lg border border-gray-700 bg-gray-700 text-white focus:outline-none focus:ring-2 focus:ring-[#E2725B] transition duration-200">
                        </div>
                        <button type="submit" id="searchLeadsBtn" class="glow-button w-full px-6 py-3 rounded-lg font-bold bg-[#E2725B] hover:bg-[#C86650] text-white transition-colors duration-300">
                            Search for Leads
                        </button>
                    </form>
                </div>
            </section>

            <!-- Inbox Section -->
            <section id="inbox" class="content-section hidden">
                <h2 class="text-3xl font-bold text-white mb-6">Unified Inbox</h2>
                <div class="flex flex-col lg:flex-row gap-6 h-full">
                    <div class="bg-[#192350] rounded-2xl shadow-lg border border-gray-700 w-full lg:w-1/3 flex flex-col">
                        <div class="p-4 border-b border-gray-700">
                            <h3 class="text-xl font-bold text-white">Conversations</h3>
                        </div>
                        <div id="conversationsList" class="flex-grow overflow-y-auto divide-y divide-gray-700">
                            <div class="p-4 text-center text-gray-400">Loading conversations...</div>
                        </div>
                    </div>
                    <div class="bg-[#192350] rounded-2xl shadow-lg border border-gray-700 w-full lg:w-2/3 flex flex-col h-full">
                        <div id="conversationHeader" class="p-4 border-b border-gray-700 flex items-center justify-between">
                            <div id="conversationTitle" class="text-xl font-bold text-white">Select a conversation</div>
                        </div>
                        <div id="conversationBody" class="flex-grow overflow-y-auto p-4 space-y-4">
                            <div class="p-4 text-center text-gray-400">No conversation selected.</div>
                        </div>
                    </div>
                </div>
            </section>

            <section id="settings" class="content-section hidden">
                <h2 class="text-3xl font-bold text-white mb-6">Account Settings</h2>
                <div class="bg-[#192350] p-6 rounded-2xl shadow-lg border border-gray-700 mb-8">
                    <h3 class="text-xl font-bold text-white mb-4">Twilio Integration</h3>
                    <form id="twilioForm" class="space-y-4">
                        <div>
                            <label for="twilioAccountSid" class="block text-sm font-medium text-gray-400">Account SID</label>
                            <input type="text" id="twilioAccountSid" name="twilioAccountSid" required
                                class="w-full px-4 py-2 rounded-lg border border-gray-700 bg-gray-700 text-white focus:outline-none focus:ring-2 focus:ring-[#E2725B] transition duration-200" placeholder="Enter your Twilio Account SID">
                        </div>
                        <div>
                            <label for="twilioAuthToken" class="block text-sm font-medium text-gray-400">Auth Token</label>
                            <input type="password" id="twilioAuthToken" name="twilioAuthToken" required
                                class="w-full px-4 py-2 rounded-lg border border-gray-700 bg-gray-700 text-white focus:outline-none focus:ring-2 focus:ring-[#E2725B] transition duration-200" placeholder="Enter your Twilio Auth Token">
                        </div>
                        <div>
                            <label for="twilioPhoneNumber" class="block text-sm font-medium text-gray-400">Twilio Phone Number</label>
                            <input type="tel" id="twilioPhoneNumber" name="twilioPhoneNumber" required
                                class="w-full px-4 py-2 rounded-lg border border-gray-700 bg-gray-700 text-white focus:outline-none focus:ring-2 focus:ring-[#E2725B] transition duration-200" placeholder="e.g., +15017122661">
                        </div>
                        <button type="submit" class="glow-button w-full px-6 py-3 rounded-lg font-bold bg-[#E2725B] hover:bg-[#C86650] text-white transition-colors duration-300">
                            Connect Twilio
                        </button>
                        <div id="twilioMessage" class="mt-4 text-center text-sm font-medium hidden"></div>
                    </form>
                </div>
                <div class="bg-[#192350] p-6 rounded-2xl shadow-lg border border-gray-700 mb-8">
                    <h3 class="text-xl font-bold text-white mb-4">HubSpot Integration</h3>
                    <form id="hubspotForm" class="space-y-4">
                        <div>
                            <label for="hubspotApiKey" class="block text-sm font-medium text-gray-400">HubSpot API Key</label>
                            <input type="text" id="hubspotApiKey" name="hubspotApiKey" required class="w-full px-4 py-2 rounded-lg border border-gray-700 bg-gray-700 text-white focus:outline-none focus:ring-2 focus:ring-[#E2725B] transition duration-200" placeholder="Enter your private HubSpot API key">
                        </div>
                        <button type="submit" class="glow-button w-full px-6 py-3 rounded-lg font-bold bg-[#E2725B] hover:bg-[#C86650] text-white transition-colors duration-300">
                            Connect HubSpot
                        </button>
                        <div id="hubspotMessage" class="mt-4 text-center text-sm font-medium hidden"></div>
                    </form>
                </div>
                <div class="bg-[#192350] p-6 rounded-2xl shadow-lg border border-gray-700 mb-8">
                    <h3 class="text-xl font-bold text-white mb-4">Zoho CRM Integration</h3>
                    <form id="zohoForm" class="space-y-4">
                        <div>
                            <label for="zohoApiKey" class="block text-sm font-medium text-gray-400">Zoho API Key</label>
                            <input type="text" id="zohoApiKey" name="zohoApiKey" required class="w-full px-4 py-2 rounded-lg border border-gray-700 bg-gray-700 text-white focus:outline-none focus:ring-2 focus:ring-[#E2725B] transition duration-200" placeholder="Enter your Zoho API key">
                        </div>
                        <button type="submit" class="glow-button w-full px-6 py-3 rounded-lg font-bold bg-[#E2725B] hover:bg-[#C86650] text-white transition-colors duration-300">
                            Connect Zoho
                        </button>
                        <div id="zohoMessage" class="mt-4 text-center text-sm font-medium hidden"></div>
                    </form>
                </div>
                <div class="bg-[#192350] p-6 rounded-2xl shadow-lg border border-gray-700 mb-8">
                    <h3 class="text-xl font-bold text-white mb-4">Bitrix24 Webhook Integration</h3>
                    <form id="bitrixForm" class="space-y-4">
                        <div>
                            <label for="bitrixWebhookUrl" class="block text-sm font-medium text-gray-400">Webhook URL</label>
                            <input type="url" id="bitrixWebhookUrl" name="bitrixWebhookUrl" required class="w-full px-4 py-2 rounded-lg border border-gray-700 bg-gray-700 text-white focus:outline-none focus:ring-2 focus:ring-[#E2725B] transition duration-200" placeholder="Enter your Bitrix24 incoming webhook URL">
                        </div>
                        <button type="submit" class="glow-button w-full px-6 py-3 rounded-lg font-bold bg-[#E2725B] hover:bg-[#C86650] text-white transition-colors duration-300">
                            Connect Bitrix24
                        </button>
                        <div id="bitrixMessage" class="mt-4 text-center text-sm font-medium hidden"></div>
                    </form>
                </div>
            </section>
        </div>
    </main>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, onAuthStateChanged, signOut, signInWithCustomToken, signInAnonymously } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, onSnapshot, doc, collection, addDoc, updateDoc, setDoc, getDoc } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        var firebaseConfig = JSON.parse(typeof __firebase_config !== 'undefined' ? __firebase_config : '{}');
        var initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;
        var appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';

        var app = initializeApp(firebaseConfig);
        var auth = getAuth(app);
        var db = getFirestore(app);

        var authContainer = document.getElementById('authContainer');
        var dashboardContainer = document.getElementById('dashboardContainer');
        var signupForm = document.getElementById('signupForm');
        var loginForm = document.getElementById('loginForm');
        var signupFormContainer = document.getElementById('signupFormContainer');
        var loginFormContainer = document.getElementById('loginFormContainer');
        var showSignupLink = document.getElementById('showSignupLink');
        var showLoginLink = document.getElementById('showLoginLink');
        var signupErrorDiv = document.getElementById('signupError');
        var loginErrorDiv = document.getElementById('loginError');
        var logoutButton = document.getElementById('logoutButton');
        var openSidebarBtn = document.getElementById('openSidebar');
        var closeSidebarBtn = document.getElementById('closeSidebar');
        var sidebar = document.getElementById('sidebar');
        var navLinks = document.querySelectorAll('#sidebar nav a');
        var contentSections = document.querySelectorAll('.content-section');

        var campaignsTableBody = document.getElementById('campaignsTableBody');
        var formMessage = document.getElementById('formMessage');
        var twilioForm = document.getElementById('twilioForm');
        var hubspotForm = document.getElementById('hubspotForm');
        var zohoForm = document.getElementById('zohoForm');
        var bitrixForm = document.getElementById('bitrixForm');
        var createCampaignForm = document.getElementById('createCampaignForm');
        var aiTemperatureInput = document.getElementById('aiTemperature');
        var tempValueSpan = document.getElementById('tempValue');
        var contactSourceSelect = document.getElementById('contactSource');
        var manualInputDiv = document.getElementById('manualInput');
        var csvInputDiv = document.getElementById('csvInput');
        var crmInputDiv = document.getElementById('crmInput');

        var currentUserId = null;

        onAuthStateChanged(auth, function(user) {
            if (user) {
                currentUserId = user.uid;
                loadCredentials('twilio');
                loadCredentials('hubspot');
                loadCredentials('zoho');
                loadCredentials('bitrix');
            }
        });

        function loadCredentials(service) {
            if (!currentUserId) return;
            const credentialsRef = doc(db, 'artifacts', appId, 'users', currentUserId, 'integrations', service);
            getDoc(credentialsRef).then(docSnapshot => {
                if (docSnapshot.exists()) {
                    const credentials = docSnapshot.data();
                    const form = document.getElementById(`${service}Form`);
                    if (form) {
                        for (const key in credentials) {
                            const input = form.querySelector(`[name="${service}${key.charAt(0).toUpperCase() + key.slice(1)}"]`);
                            if (input) {
                                input.value = credentials[key];
                            }
                        }
                    }
                }
            }).catch(error => {
                console.error(`Error loading ${service} credentials:`, error);
            });
        }

        aiTemperatureInput.addEventListener('input', function() {
            tempValueSpan.textContent = this.value;
        });

        contactSourceSelect.addEventListener('change', function() {
            manualInputDiv.classList.add('hidden');
            csvInputDiv.classList.add('hidden');
            crmInputDiv.classList.add('hidden');
            switch (this.value) {
                case 'manual':
                    manualInputDiv.classList.remove('hidden');
                    break;
                case 'csv':
                    csvInputDiv.classList.remove('hidden');
                    break;
                case 'crm':
                    crmInputDiv.classList.remove('hidden');
                    break;
            }
        });

        onAuthStateChanged(auth, function(user) {
            if (user) {
                authContainer.classList.add('hidden');
                dashboardContainer.classList.remove('hidden');
                currentUserId = user.uid;
            } else {
                authContainer.classList.remove('hidden');
                dashboardContainer.classList.add('hidden');
            }
        });
        if (initialAuthToken) {
            signInWithCustomToken(auth, initialAuthToken).catch(function(error) {
                console.error("Error signing in with custom token:", error);
                signInAnonymously(auth).catch(function(anonError) {
                    console.error("Error signing in anonymously:", anonError);
                });
            });
        }
        showSignupLink.addEventListener('click', function(e) {
            e.preventDefault();
            loginFormContainer.classList.add('hidden');
            signupFormContainer.classList.remove('hidden');
        });
        showLoginLink.addEventListener('click', function(e) {
            e.preventDefault();
            signupFormContainer.classList.add('hidden');
            loginFormContainer.classList.remove('hidden');
        });
        signupForm.addEventListener('submit', function(e) {
            e.preventDefault();
            var email = signupForm.signupEmail.value;
            var password = signupForm.signupPassword.value;
            signupErrorDiv.classList.add('hidden');
            createUserWithEmailAndPassword(auth, email, password).then(function(userCredential) {
                var userDocRef = doc(db, 'artifacts', appId, 'users', userCredential.user.uid);
                setDoc(userDocRef, { email: email, createdAt: new Date().toISOString() });
            }).catch(function(error) {
                signupErrorDiv.textContent = getErrorMessage(error.code);
                signupErrorDiv.classList.remove('hidden');
            });
        });
        loginForm.addEventListener('submit', function(e) {
            e.preventDefault();
            var email = loginForm.loginEmail.value;
            var password = loginForm.loginPassword.value;
            loginErrorDiv.classList.add('hidden');
            signInWithEmailAndPassword(auth, email, password).catch(function(error) {
                loginErrorDiv.textContent = getErrorMessage(error.code);
                loginErrorDiv.classList.remove('hidden');
            });
        });
        function getErrorMessage(errorCode) {
            switch(errorCode) {
                case 'auth/email-already-in-use': return 'The email address is already in use.';
                case 'auth/invalid-email': return 'The email address is not valid.';
                case 'auth/operation-not-allowed': return 'Email/password sign-in is not enabled.';
                case 'auth/weak-password': return 'The password is too weak.';
                case 'auth/user-not-found': case 'auth/wrong-password': return 'Incorrect email or password. Please try again.';
                default: return 'An unknown error occurred.';
            }
        }

        // Dashboard Functionality
        logoutButton.addEventListener('click', function() { signOut(auth); });
        openSidebarBtn.addEventListener('click', function() { sidebar.classList.remove('-translate-x-full'); });
        closeSidebarBtn.addEventListener('click', function() { sidebar.classList.add('-translate-x-full'); });
        navLinks.forEach(function(link) {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                var targetId = e.currentTarget.getAttribute('href').substring(1);
                navLinks.forEach(function(navLink) { navLink.classList.remove('active-link'); });
                e.currentTarget.classList.add('active-link');
                contentSections.forEach(function(section) {
                    if (section.id === targetId) { section.classList.remove('hidden'); }
                    else { section.classList.add('hidden'); }
                });
                sidebar.classList.add('-translate-x-full');
            });
        });

        // Campaign Form Submission
        if (createCampaignForm) {
            createCampaignForm.addEventListener('submit', function(e) {
                e.preventDefault();
                var name = document.getElementById('campaignName').value;
                var script = document.getElementById('campaignScript').value;
                var phone = document.getElementById('targetPhoneNumber').value;
                var language = document.getElementById('aiLanguage').value;
                var tone = document.getElementById('aiTone').value;

                if (!name || !script) {
                    showMessage("Campaign name and script are required.", 'error');
                    return;
                }

                if (phone) {
                    fetch('/.netlify/functions/make-call', {
                        method: 'POST',
                        body: JSON.stringify({ targetPhoneNumber: phone, script: script, userId: currentUserId, language: language, tone: tone }),
                    }).then(function(response) {
                        return response.json();
                    }).then(function(data) {
                        if (data.error) {
                            showMessage("Error initiating call: " + data.error, 'error');
                        } else {
                            showMessage(data.message, 'success');
                        }
                    }).catch(function(error) {
                        console.error('Call error:', error);
                        showMessage("An error occurred while making the call.", 'error');
                    });
                }

                addDoc(collection(db, 'artifacts', appId, 'users', currentUserId, 'campaigns'), {
                    name: name,
                    script: script,
                    leadsCount: 0,
                    status: 'Active',
                    createdAt: new Date().toISOString(),
                }).then(function() {
                    showMessage("Campaign created successfully!");
                    createCampaignForm.reset();
                }).catch(function(error) {
                    console.error("Error creating campaign:", error);
                    showMessage("Failed to create campaign. Please try again.", 'error');
                });
            });
        }

        // CRM Integration Forms
        if (hubspotForm) {
            hubspotForm.addEventListener('submit', function(e) {
                e.preventDefault();
                var apiKey = document.getElementById('hubspotApiKey').value;
                saveCredentials('hubspot', { apiKey: apiKey }, 'hubspotMessage', 'HubSpot connected successfully!');
            });
        }
        if (zohoForm) {
            zohoForm.addEventListener('submit', function(e) {
                e.preventDefault();
                var apiKey = document.getElementById('zohoApiKey').value;
                saveCredentials('zoho', { apiKey: apiKey }, 'zohoMessage', 'Zoho connected successfully!');
            });
        }
        if (bitrixForm) {
            bitrixForm.addEventListener('submit', function(e) {
                e.preventDefault();
                var webhookUrl = document.getElementById('bitrixWebhookUrl').value;
                saveCredentials('bitrix', { webhookUrl: webhookUrl }, 'bitrixMessage', 'Bitrix24 connected successfully!');
            });
        }
        if (twilioForm) {
            twilioForm.addEventListener('submit', function(e) {
                e.preventDefault();
                var accountSid = document.getElementById('twilioAccountSid').value;
                var authToken = document.getElementById('twilioAuthToken').value;
                var phoneNumber = document.getElementById('twilioPhoneNumber').value;
                saveCredentials('twilio', { accountSid: accountSid, authToken: authToken, phoneNumber: phoneNumber }, 'twilioMessage', 'Twilio connected successfully!');
            });
        }

        function saveCredentials(service, credentials, messageElementId, successMessage) {
            if (!currentUserId) {
                showMessage(messageElementId, 'User not authenticated.', 'error');
                return;
            }
            var credentialsRef = doc(db, 'artifacts', appId, 'users', currentUserId, 'integrations', service);
            setDoc(credentialsRef, credentials).then(function() {
                showMessage(messageElementId, successMessage, 'success');
            }).catch(function(error) {
                console.error(`Error connecting ${service}:`, error);
                showMessage(messageElementId, `Failed to connect ${service}.`, 'error');
            });
        }

        function showMessage(elementId, msg, type) {
            var element = document.getElementById(elementId);
            if (element) {
                element.textContent = msg;
                element.classList.remove('hidden', 'text-green-400', 'text-red-400');
                if (type === 'success') { element.classList.add('text-green-400'); }
                else if (type === 'error') { element.classList.add('text-red-400'); }
                else { element.classList.add('text-blue-400'); }
                setTimeout(function() { element.classList.add('hidden'); }, 5000);
            }
        }

        window.addEventListener('load', function() {
            var startSection = window.location.hash.substring(1) || 'campaigns';
            var initialLink = document.querySelector('a[href="#' + startSection + '"]');
            if (initialLink) {
                initialLink.classList.add('active-link');
                var initialSection = document.getElementById(startSection);
                if (initialSection) {
                    initialSection.classList.remove('hidden');
                }
            }
        });
    </script>
</body>
</html>